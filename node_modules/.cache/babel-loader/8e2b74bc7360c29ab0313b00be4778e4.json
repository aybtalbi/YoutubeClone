{"ast":null,"code":"import _toConsumableArray from\"C:/Users/ayoub/reactApp/AppYoutubeApi/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _objectSpread from\"C:/Users/ayoub/reactApp/AppYoutubeApi/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"C:/Users/ayoub/reactApp/AppYoutubeApi/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{useState,useEffect,useContext}from'react';import ApiYoutube from'../store/API/ApiYoutube';import VideoList from'../components/videos/VideoList';import Context from'../store/Context/context';import Spinner from'../components/ui/Spinner';import Spinner2 from'../components/ui/Spinner2';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function TousLesVideos(){var ctx=useContext(Context);var _useState=useState(true),_useState2=_slicedToArray(_useState,2),isLoading=_useState2[0],setIsLoading=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),loadedvideos=_useState4[0],setLoadedvideos=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),isScrolling=_useState6[0],setScrolling=_useState6[1];var _useState7=useState(1),_useState8=_slicedToArray(_useState7,2),page=_useState8[0],setPage=_useState8[1];var _useState9=useState(''),_useState10=_slicedToArray(_useState9,2),pageSuivant=_useState10[0],setPageSuivant=_useState10[1];var recherche=ctx.recherche;var ordreRecherche=ctx.ordreRecherche;useEffect(function(){!isScrolling&&setIsLoading(true);ApiYoutube().get('/search',{params:{q:recherche,pageToken:isScrolling?pageSuivant:null,order:ordreRecherche}}).then(function(response){return response.data;}).then(function(data){setPageSuivant(data.nextPageToken);var videos=[];for(var key in data.items){var video=_objectSpread({key:key},data.items[key]);//\nvideos.push(video);}setIsLoading(false);//au cas du scrolling on ajoute les nouveaux videos par concat\nisScrolling?setLoadedvideos([].concat(_toConsumableArray(loadedvideos),videos)):// cas du recherche\nsetLoadedvideos(videos);setScrolling(false);});},[recherche,page,ordreRecherche]);window.onscroll=function(){if(window.innerHeight+document.documentElement.scrollTop===document.documentElement.offsetHeight){setScrolling(true);setPage(function(prevPage){return prevPage+1;});}};if(isLoading){return/*#__PURE__*/_jsx(Spinner,{});}return/*#__PURE__*/_jsxs(\"section\",{children:[/*#__PURE__*/_jsx(VideoList,{videos:loadedvideos}),isScrolling&&/*#__PURE__*/_jsx(Spinner2,{})]});}export default TousLesVideos;","map":{"version":3,"sources":["C:/Users/ayoub/reactApp/AppYoutubeApi/src/pages/TousLesVideos.js"],"names":["useState","useEffect","useContext","ApiYoutube","VideoList","Context","Spinner","Spinner2","TousLesVideos","ctx","isLoading","setIsLoading","loadedvideos","setLoadedvideos","isScrolling","setScrolling","page","setPage","pageSuivant","setPageSuivant","recherche","ordreRecherche","get","params","q","pageToken","order","then","response","data","nextPageToken","videos","key","items","video","push","window","onscroll","innerHeight","document","documentElement","scrollTop","offsetHeight","prevPage"],"mappings":"2dAAA,OAASA,QAAT,CAAmBC,SAAnB,CAA8BC,UAA9B,KAAgD,OAAhD,CACA,MAAOC,CAAAA,UAAP,KAAuB,yBAAvB,CACA,MAAOC,CAAAA,SAAP,KAAsB,gCAAtB,CACA,MAAOC,CAAAA,OAAP,KAAoB,0BAApB,CACA,MAAOC,CAAAA,OAAP,KAAoB,0BAApB,CACA,MAAOC,CAAAA,QAAP,KAAqB,2BAArB,C,wFAEA,QAASC,CAAAA,aAAT,EAAyB,CACvB,GAAMC,CAAAA,GAAG,CAAGP,UAAU,CAACG,OAAD,CAAtB,CACA,cAAkCL,QAAQ,CAAC,IAAD,CAA1C,wCAAOU,SAAP,eAAkBC,YAAlB,eACA,eAAwCX,QAAQ,CAAC,EAAD,CAAhD,yCAAOY,YAAP,eAAqBC,eAArB,eACA,eAAoCb,QAAQ,CAAC,KAAD,CAA5C,yCAAOc,WAAP,eAAoBC,YAApB,eACA,eAAwBf,QAAQ,CAAC,CAAD,CAAhC,yCAAOgB,IAAP,eAAaC,OAAb,eACA,eAAqCjB,QAAQ,CAAC,EAAD,CAA7C,0CAAOkB,WAAP,gBAAmBC,cAAnB,gBACA,GAAMC,CAAAA,SAAS,CAAGX,GAAG,CAACW,SAAtB,CACA,GAAMC,CAAAA,cAAc,CAAGZ,GAAG,CAACY,cAA3B,CAEApB,SAAS,CAAC,UAAM,CACd,CAACa,WAAD,EAAgBH,YAAY,CAAC,IAAD,CAA5B,CACAR,UAAU,GAAGmB,GAAb,CAAiB,SAAjB,CAA4B,CAAEC,MAAM,CAAE,CAAGC,CAAC,CAAEJ,SAAN,CAAkBK,SAAS,CAACX,WAAW,CAAGI,WAAH,CAAiB,IAAxD,CAA+DQ,KAAK,CAACL,cAArE,CAAV,CAA5B,EACGM,IADH,CACQ,SAACC,QAAD,CAAc,CAClB,MAAOA,CAAAA,QAAQ,CAACC,IAAhB,CACD,CAHH,EAIGF,IAJH,CAIQ,SAACE,IAAD,CAAU,CACdV,cAAc,CAACU,IAAI,CAACC,aAAN,CAAd,CACA,GAAMC,CAAAA,MAAM,CAAG,EAAf,CACA,IAAK,GAAMC,CAAAA,GAAX,GAAkBH,CAAAA,IAAI,CAACI,KAAvB,CAA8B,CAC5B,GAAMC,CAAAA,KAAK,gBACTF,GAAG,CAAEA,GADI,EAENH,IAAI,CAACI,KAAL,CAAWD,GAAX,CAFM,CAAX,CAIA;AACAD,MAAM,CAACI,IAAP,CAAYD,KAAZ,EACD,CACDvB,YAAY,CAAC,KAAD,CAAZ,CACA;AACAG,WAAW,CAAGD,eAAe,8BAAKD,YAAL,EAAqBmB,MAArB,EAAlB,CACX;AACAlB,eAAe,CAACkB,MAAD,CAFf,CAIAhB,YAAY,CAAC,KAAD,CAAZ,CACD,CAtBH,EAuBD,CAzBQ,CAyBN,CAACK,SAAD,CAAWJ,IAAX,CAAgBK,cAAhB,CAzBM,CAAT,CA4BAe,MAAM,CAACC,QAAP,CAAkB,UAAY,CAC5B,GAAGD,MAAM,CAACE,WAAP,CAAqBC,QAAQ,CAACC,eAAT,CAAyBC,SAA9C,GAA4DF,QAAQ,CAACC,eAAT,CAAyBE,YAAxF,CACA,CACE3B,YAAY,CAAC,IAAD,CAAZ,CACAE,OAAO,CAAC,SAAA0B,QAAQ,QAAIA,CAAAA,QAAQ,CAAC,CAAb,EAAT,CAAP,CACD,CACF,CAND,CAQA,GAAIjC,SAAJ,CAAe,CACb,mBACE,KAAC,OAAD,IADF,CAGD,CAED,mBACE,wCACE,KAAC,SAAD,EAAW,MAAM,CAAEE,YAAnB,EADF,CAEGE,WAAW,eAAI,KAAC,QAAD,IAFlB,GADF,CAMD,CAED,cAAeN,CAAAA,aAAf","sourcesContent":["import { useState, useEffect ,useContext } from 'react';\nimport ApiYoutube from '../store/API/ApiYoutube'\nimport VideoList from '../components/videos/VideoList';\nimport Context from '../store/Context/context';\nimport Spinner from '../components/ui/Spinner';\nimport Spinner2 from '../components/ui/Spinner2';\n\nfunction TousLesVideos() { \n  const ctx = useContext(Context);\n  const [isLoading, setIsLoading] = useState(true);\n  const [loadedvideos, setLoadedvideos] = useState([]);\n  const [isScrolling, setScrolling] = useState(false);\n  const [page, setPage] = useState(1);\n  const [pageSuivant,setPageSuivant] = useState('')\n  const recherche = ctx.recherche\n  const ordreRecherche = ctx.ordreRecherche\n\n  useEffect(() => {\n    !isScrolling && setIsLoading(true);\n    ApiYoutube().get('/search', { params: {  q: recherche , pageToken:isScrolling ? pageSuivant : null , order:ordreRecherche} })\n      .then((response) => {\n        return response.data;\n      })\n      .then((data) => {\n        setPageSuivant(data.nextPageToken)\n        const videos = [];\n        for (const key in data.items) {\n          const video = {\n            key: key ,\n            ...data.items[key]\n          };\n          //\n          videos.push(video);\n        }\n        setIsLoading(false);\n        //au cas du scrolling on ajoute les nouveaux videos par concat\n        isScrolling ? setLoadedvideos([...loadedvideos,...videos]):\n        // cas du recherche\n        setLoadedvideos(videos)\n\n        setScrolling(false)\n      });\n  }, [recherche,page,ordreRecherche]);\n\n\n  window.onscroll = function () {\n    if(window.innerHeight + document.documentElement.scrollTop === document.documentElement.offsetHeight)\n    {\n      setScrolling(true)\n      setPage(prevPage => prevPage+1)\n    }\n  }\n\n  if (isLoading) {\n    return (\n      <Spinner/>\n    );\n  }\n\n  return (\n    <section>\n      <VideoList videos={loadedvideos} />\n      {isScrolling && <Spinner2/>}\n    </section>\n  );\n}\n\nexport default TousLesVideos;\n"]},"metadata":{},"sourceType":"module"}